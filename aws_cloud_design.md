# AWSクラウド設計完全ガイド

## Links

- [最適なサービスを選定して組み合わせる　AWSクラウド設計完全ガイド](https://info.nikkeibp.co.jp/media/LIN/atcl/books/021700051/)

## 1. エンタープライズシステム基板設計のアプローチ

- AWSでのアーキテクチャ設計のアプローチ
  - Well-Architectedフレームワークという、AWSを活用したシステムを構築する上でのベストプラクティスを提供してくれている
  - 積極的にマネージドサービスを利用することが推奨されているが、マネージドサービスの選定では、SLA/冗長化構成/マネージドサービスのハードリミットなどを考慮する必要がある
  - いきなり結構具体的な話が出てくる

## 2. AWSにおけるインフラストラクチャ選定のアプローチ

- 基本的なアプローチ方法と、XaaSの説明、ストレージとデータベースとネットワークにおけるサービス選定のポイント
- 章構成がちょっとわかりずらいが、それだけストレージ、データベース、ネットワークの設計が他に与える影響が大きいということか

## 3. 実行アーキテクチャの設計

- LambdaとRDSを組み合わせて用いる場合、データベースへのコネクション数の管理に注意が必要になる
  - もし同時接続数が問題になる場合、RDS Proxyを使うか、RDS Data APIを使うことで回避することができる
- マイクロサービスアーキテクチャをAWS上で実現する手段としては、ECSとEKSがあり、ECSはAWSロックインしてしまう一方で、EKSは最新のKubernetesに追従しなければならなくなるデメリットがある
- BFF (Backend for Frontend)
  - AppSyncを使えば、FEはGraphQLを使って必要十分なデータを要求することで、AppSyncがクエリに対応するリゾルバに設定されたBEを呼び出してデータを集約してくれる。
  - FEとBEをSPAより更に粗結合にすることができる
- マイクロサービス間のトランザクションの実装方法
  - オーケストレーションパターン
    - Step Functionsなど、トランザクションの管理者を用意し、途中の処理で終了したら、それまでの処理のキャンセル要求を行う
  - コレオグラフィパターン
    - Event BridgeやSNS+SQSなどを使い、処理に失敗したときにはキャンセル処理を実行するようなイベントルールを設定しておくことで、中央管理することなくイベントの伝搬だけでトランザクションを実現する

## 4. データ連携アーキテクチャの設計

- Enterprise Integration Patternsではデータ連携のベストプラクティスとして、以下の4つをあげている
  - API連携
  - ファイル連携
  - キュー連携
  - データベース共有
- 上記に加え、ストリーミング連携も近年よく使われる
