# リンク

https://www.oreilly.co.jp/books/9784814400454/

# 1. ソフトウェア設計の技
## ガイドライン１：ソフトウェア設計の重要性を理解する

- ソフトウェア設計は、ソフトウェア開発で最も重要であり、保守のコストに大きく影響する
- ソフトウェア設計とは、ソフトウェアコンポーネント間の依存関係を管理する技である。人工的（技術的）依存関係を最小化し、必要な抽象化を導入し、妥協点を見出すことを目的とする。
- ソフトウェアアーキテクチャには一般的な定義はないが、一般に全体にかかる判断を下すものであり、将来変更するのが最も困難な部分である

## ガイドライン２：将来の変更に備え設計する

- SRP (単一責任の原則)に従い、関心を分離し、無関係の直行するアスペクトの結合を避け、連鎖的に必要となる変更を減らす
- DRY原則に従い、重複を最小化する
- 将来の変更が確実でなければ、時期尚早な抽象化は避ける

## ガイドライン３：インタフェースを分離し人工的関係性を排除する

- 使いもしないメソッドへの依存など、クライアントに矯正すべきではない

## ガイドライン４：テスト可用性に備え設計する

- テストは必要不可欠
- テストが必要なprivateメンバ関数は、クラス内で宣言する場所を間違えている
- メンバ関数より、非メンバかつ非friend関数を優先することで、カプセル化を促進し、テスト可用性を高めることができる

## ガイドライン５：拡張に備え設計する

- 開放・閉鎖原則（OCP）のとおり、拡張は用意であるべきで、理想的には単にコードを追加するだけで住むべきであり、他コンポーネントの既存コードを改造するなどはあるべきではない
- コードの追加が容易になるよう、基底クラス、テンプレート、関数オーバーロード、テンプレートの特殊化といった手法を検討する
- C++標準ライブラリは、拡張に備えた設計の大変良いお手本である

# 2. 抽象化の技
## ガイドライン６：抽象化から期待される動作に従う

- LSP（リスコフ置換原則）を守るためには、下記が常に守られることを保証しなければならない
  - 具象クラスでは事前条件を強めてはならない
  - 具象クラスでは事後条件を弱めてはならない
  - 具象クラスのメソッドの戻り型は、共変でなければならない
    - つまり、具象クラスをそのまま返せなければならない
  - 具象クラスのメソッドの引数の型は、反変でなければならない
    - つまり、基底クラスをそのまま入力にできなければならない
  - 基底クラスの不変条件は、具象クラスでも維持しなければならない

- ポインタが指す具象クラスの型をdynamic_castなどで判別し、それによって呼び出し側の制御を変えている場合、紛れもなくLSP違反であり、非常に良くない
  - 派生クラスの動作に新たな依存関係を発生させてしまうため

- 抽象化が期待する内容の明確化や、誤解の余地がない表現を明文化することも重要
  - 参考：[C++標準にあるイテレータコンセプトの説明文](https://en.cppreference.com/w/cpp/iterator)
